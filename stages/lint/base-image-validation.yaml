base-image-validation:
  extends: .lint
  script:
    - |
      if [[ "${CI_COMMIT_BRANCH}" == "master" || "${CI_COMMIT_BRANCH}" == "development" ]] && [[ "${CI_COMMIT_REF_PROTECTED}" != true ]]; then
        echo "This pipeline is running on an unprotected '${CI_COMMIT_BRANCH}' branch. Please protect '${CI_COMMIT_BRANCH}' before running the pipeline on this branch"
        echo "Exiting"
        exit 1
      fi
    - python3 "${PIPELINE_REPO_DIR}/stages/lint/base-image-validation.py"
  artifacts:
    paths: []
    reports:
      dotenv: variables.env
  retry:
    max: 2
    when: runner_system_failure
