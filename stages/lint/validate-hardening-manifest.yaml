validate-hardening-manifest:
  stage: lint
  extends:
    - .setup_modules
  needs:
    - load-scripts
  retry:
    max: 2
    when: runner_system_failure
  script:
    - 'python3 "${PIPELINE_REPO_DIR}/stages/lint/validate_hardening_manifest.py"'

test-image:
  stage: lint
  # extends: .setup_modules
  needs:
    - load-scripts
  image: registry1.dso.mil/ironbank-staging/ironbank-pipelines/oscap-podman:ibci-2152749
  script:
    - 'cp -rf /home/python/.cache /root'
    - 'source "$(poetry env info -C "${MODULES_DEPS_PATH}" --path)"/bin/activate'
    - 'poetry install -C "${MODULES_PACKAGE_PATH}" --only-root'
