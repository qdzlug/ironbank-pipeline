include:
  - local: stages/preprocess/base.yaml

# clone templates repo as an artifact so it can be used with other jobs
load scripts:
  extends: .preprocess
  #  following image is a placeholder, reference to the gl runner we will use for testing
  image: ${REGISTRY_URL}/gitlab/gitlab-runner/gitlab-runner:v13.2.2
  cache: {}
  script:
    # May need to include validation here for auth clone
    - mkdir -p ${PIPELINE_REPO_DIR}
    - git clone -q --depth 50 "https://repo1.dsop.io/dsop/ironbank-pipeline.git" "${PIPELINE_REPO_DIR}"
    # - git clone https://${CI_BUILD_TOKEN}@gitlab.repo1.dsop.io/dsop/ironbank-pipeline.git
    - rm -rf ${PIPELINE_REPO_DIR}/.git
  artifacts:
    expire_in: 1 day
    paths:
      - ${PIPELINE_REPO_DIR}/
