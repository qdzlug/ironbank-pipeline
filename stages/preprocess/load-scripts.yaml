include:
  - local: stages/preprocess/base.yaml

# clone templates repo as an artifact so it can be used with other jobs
load scripts:
  extends: .preprocess
  cache: {}
  script:
    - 'mkdir -p "${PIPELINE_REPO_DIR}"'
    - "mkdir security-profile"
    - 'git clone -q --depth 1 --branch "${TARGET_BRANCH}" "https://repo1.dsop.io/ironbank-tools/ironbank-pipeline.git" "${PIPELINE_REPO_DIR}"'
    - 'git clone -q --depth 1 --branch "master" "https://repo1.dso.mil/ironbank-tools/complianceascode.git" "security-profile"'
    - 'rm -rf "${PIPELINE_REPO_DIR}/.git"'
  artifacts:
    when: always
    expire_in: 1 day
    paths:
      - "${PIPELINE_REPO_DIR}"
      - "security-profile/"
