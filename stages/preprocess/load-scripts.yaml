include:
  - local: stages/preprocess/base.yaml

# clone templates repo as an artifact so it can be used with other jobs
load scripts:
  extends: .preprocess
  image: ${REGISTRY_URL}/gitlab/gitlab-runner/gitlab-runner:v13.2.2
  cache: {}
  before_script:
    docker login ${REGISTRY_URL} -u ${ironbank_robot_user} -p ${ironbank_user_pass}
  script:
    - mkdir -p "${PIPELINE_REPO_DIR}"
    - git clone -q --depth 1 "https://repo1.dsop.io/dsop/ironbank-pipeline.git" "${PIPELINE_REPO_DIR}"
    - rm -rf "${PIPELINE_REPO_DIR}/.git"
  artifacts:
    expire_in: 1 day
    paths:
      - "${PIPELINE_REPO_DIR}"
