harbor:
  extends: .publish
  variables:
    IMAGE_FILE: "${CI_PROJECT_NAME}-${IMG_VERSION}"
  only:
    - master
  dependencies:
    - build
    - load scripts
  script:
    - |
      if [[ "${SPECIAL_IMAGE_PATH}" ]]; then
        "${PIPELINE_REPO_DIR}/stages/publish/special-upload-to-harbor.sh"
      fi
    - '"${PIPELINE_REPO_DIR}/stages/publish/upload-to-harbor.sh" "${REGISTRY_URL}/${IM_NAME}" "${IMG_VERSION}"'
