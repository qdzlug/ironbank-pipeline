write json documentation:
  extends: .documentation
  variables:
    #TODO: Put these in globals
    ARTIFACT_DIR: "${ARTIFACT_STORAGE}/documentation"
    # TODO put back in for full run
    OPENSCAP_VERSION_FILE: "${ARTIFACT_STORAGE}/scan-results/openscap/oscap-version.txt"
    TWISTLOCK_VERSION_FILE: "${ARTIFACT_STORAGE}/scan-results/twistlock/twistlock-version.txt"
    ANCHORE_VERSION_FILE: "${ARTIFACT_STORAGE}/scan-results/anchore/anchore-version.txt"
  dependencies:
    - hardening_manifest
    - load scripts
    - wl compare lint
    - openscap compliance
    - openscap cve
    - anchore scan
    - twistlock scan
    - build

  script:
    - '"${PIPELINE_REPO_DIR}/stages/documentation/write-json-docs-run.sh"'
  artifacts:
    when: always
    paths:
      - "${ARTIFACT_DIR}"
    expire_in: 1 week
