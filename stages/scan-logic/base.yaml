scan-logic:
  stage: scan-logic
  # TODO: Remove when final testing of SBOMs is complete
  allow_failure: true
  dependencies:
    - load-scripts
    - lint
    - build
    - create-sbom
  variables:
    SCAN_LOGIC_DIR: "${ARTIFACT_STORAGE}/scan-logic"
  script:
    - 'pip install --user "${PIPELINE_REPO_DIR}"'
    - 'python3 "${PIPELINE_REPO_DIR}/stages/scan-logic/scan_logic_jobs.py"'
  artifacts:
    when: always
    paths:
      - "${SCAN_LOGIC_DIR}/"
    expire_in: 1 week
    reports:
      dotenv: scan_logic.env
  retry:
    max: 2
    when: runner_system_failure
