import-artifacts:
  stage: import-artifacts
  needs:
    - load-scripts
    - lint
    - job: trufflehog
      artifacts: false
  variables:
    ARTIFACT_DIR: "${ARTIFACT_STORAGE}/import-artifacts"
    REQUESTS_CA_BUNDLE: "/etc/pki/ca-trust/extracted/openssl/ca-bundle.trust.crt"
  script:
    - 'echo "${REQUESTS_CA_BUNDLE}"'
    - 'pip install --user "${PIPELINE_REPO_DIR}"'
    - '"${PIPELINE_REPO_DIR}/stages/import-artifacts/import-run.sh"'
  artifacts:
    when: always
    paths:
      - "${ARTIFACT_DIR}/"
    expire_in: 1 week
